(function(e,t,n){"use strict";function h(n){if(n.origin!==location.origin&&!u.test(n.origin)&&n.origin!=="null")return;try{var r=JSON.parse(n.data),i=r.type;if(!f.test(i))return;var s=i.split(".",2)[1];if(l[s]){var o=l[s];for(var a=0;a<o.targets.length;a++)e.frames.postMessage(o.targets[a],i,r.data,r.options)}var c=new CustomEvent(i,{detail:r.data});c.source=n.source,c.options=r.options,t.dispatchEvent(c);var h=new CustomEvent("*."+s,{detail:r.data});h.source=n.source,h.options=r.options,h.originalType=i,t.dispatchEvent(h)}catch(p){}}function p(e,n,r){"addEventListener"in t?t.addEventListener(e,n,r):"attachEvent"in t&&t.attachEvent("on"+e,n)}function d(e,n,r){"removeEventListener"in t?t.removeEventListener(e,n):"detachEvent"in t&&t.attachEvent("on"+e,n)}function v(e){return new RegExp("^http(s)?:\\/\\/"+e.join("|")+"$","i")}function m(e){return new RegExp("\\.(?:"+e.join("|")+")$")}function g(e){return/\*/.test(e)}var r=".*",i=".postMessage",s={targetOrigin:"*"},o=[r],u=v(o),a=[i],f=m(a),l={},c=!1,y=e.frames={postMessage:function(e,t,n,r){/\..+$/.test(t)||(t+=i),r=r||{};for(var o in s)r.hasOwnProperty(o)||(r[o]=s[o]);e.postMessage(JSON.stringify({type:t,data:n,options:r}),r.targetOrigin)},receiveMessage:function(e,t,n,r){typeof e=="string"&&(r=n,n=t,t=e,e=null),r=r||this;var i=function(t){if(e&&e!==t.source&&e.contentWindow!==t.source)return;n.apply(r,arguments)};return p(t,i),{off:function(){d(t,i)}}},proxy:function(e,t){this.listen(e),Object.prototype.toString.call(t)!=="[object Array]"&&(t=[t]);var n=l[e];n?n.targets=[].concat(n.targets,target):n={targets:t},l[e]=n},receiveMessageOnce:function(e,t,n,r){var i=y.receiveMessage(e,t,function(){n&&n.apply(this,arguments),i.off()},r);return i},addPostMessageOrigin:function(e){g(e)?o=[r]:o.indexOf(e)===-1&&(y.removePostMessageOrigin(r),o.push(e),u=v(o))},removePostMessageOrigin:function(e){var t=o.indexOf(e);t!==-1&&(o.splice(t,1),u=v(o))},listen:function(e){a.indexOf(e)===-1&&(a.push(e),f=m(a)),c||(p("message",h),c=!0)},stopListening:function(e){var t=a.indexOf(e);t!==-1&&(a.splice(t,1),a.length?f=m(a):(d("message",h),c=!1))}}})(this.r=this.r||{},this),!function(e){function r(e){function i(){return r=s(),o(),r}function s(){var t=document.createElement("iframe");return t.src=e,t.setAttribute("allowTransparency","true"),t.style.display="block",t.style.width="100%",t.style.height="1px",t.style.background="transparent",t.style.border="none",t}function o(){t.listen("embedjail"),t.receiveMessage(r.contentWindow,"open.embedjail",function(e){u(e.detail)}),t.receiveMessage(r.contentWindow,"close.embedjail",function(e){a()}),window.addEventListener("message",function(e){if(e.origin!=="https://live.asknice.ly"&&e.origin!=="https://reddit.asknice.ly")return;e.data&&r&&r.contentWindow&&t.postMessage(r.contentWindow,e.data+".asknicely")})}function u(e){r.style.width=e.dimensions.width,r.style.height=e.dimensions.height,r.style.display="block",r.style.position="fixed",r.style.bottom=0,r.style.zIndex=2147483647,window.addEventListener("resize",f)}function a(){r.parentElement.removeChild(r),t.stopListening("asknicely"),window.removeEventListener("resize",f),r=undefined}var r,f=n(function(){r&&r.contentWindow&&t.postMessage(r.contentWindow,"resize.asknicely")},500);return i}var t=e.frames,n=_.debounce;$(function(){var t="web",n=e.utils.parseQueryString(document.location.search).feature;$.ajax({url:"/api/jail/asknicely.json",type:"GET",dataType:"json",data:{raw_json:1,app_name:t,feature:n},xhrFields:{withCredentials:!0}}).then(function(e){if(!e||!e.dest)return;var t=r(e.dest)();document.body.appendChild(t)})})}(window.r);